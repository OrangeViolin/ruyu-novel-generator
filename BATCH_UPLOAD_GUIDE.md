# 📦 批量上传功能使用指南

## 🎉 新功能：批量上传 + 拖拽上传

现在您可以一次性上传多个小说/拆文素材文件，支持**拖拽上传**和**文件预览**！

---

## 📝 如何使用批量上传

### 第一步：准备您的文件

将您的小说/拆文素材放在一个文件夹中，例如：
```
我的素材包/
├── 《他曾是我人间朝暮》-导语.txt
├── 《他曾是我人间朝暮》-人物设定.txt
├── 《他曾是我人间朝暮》-大纲.txt
├── 《他曾是我人间朝暮》-拆解笔记.txt
├── 追妻火葬场-导语合集.txt
└── 豪门恩怨系列-素材.docx
```

**支持的格式**：.txt、.docx、.pdf、.xlsx、.xls

### 第二步：打开上传界面

1. 访问：http://127.0.0.1:8000
2. 点击 **📚 素材库** 标签页
3. 点击 **+ 上传素材** 按钮

### 第三步：填写通用信息（可选）

您可以填写一次，应用到所有文件：

- **作品标题**：留空则自动使用文件名
- **作者**：如"顾以"（会应用到所有文件）
- **来源**：如"番茄"、"七猫"（会应用到所有文件）
- **内容类型**：选择文件类型
  - **导语**：小说开头部分
  - **大纲**：章节大纲
  - **拆解笔记**：完整拆解文档
  - **完整小说**：全本小说

**💡 提示**：如果文件名已经包含信息（如《书名》-导语.txt），可以留空标题，系统会自动从文件名提取。

### 第四步：批量选择文件（两种方式）

#### 方式一：点击选择文件

1. 点击 **📁 选择多个文件** 按钮
2. **Mac**: 按 `Cmd` 键多选文件
3. **Windows**: 按 `Ctrl` 键多选文件
4. 选择后点击"打开"

#### 方式二：拖拽上传 ⭐ 推荐

1. 在文件管理器中选中多个文件或整个文件夹的内容
2. **直接拖拽**到上传区域的虚线框内
3. 松开鼠标，文件会自动添加到列表

**优势**：
- ✅ 更直观、更快速
- ✅ 可以一次拖几十个文件
- ✅ 支持从文件夹拖拽
- ✅ 拖拽后可以预览和管理文件

**一次可以选择几十个文件！**

### 第五步：预览和管理文件

文件选择后，会显示**文件预览列表**：

```
已选择 15 个文件                    [清空]

┌────────────────────────────────┐
│ 📄 《他曾是我人间朝暮》-导语.txt  [✕] │
│    125 KB                        │
├────────────────────────────────┤
│ 📝 豪门恩怨系列-素材.docx        [✕] │
│    2.3 MB                        │
├────────────────────────────────┤
│ 📕 追妻火葬场-导语合集.pdf       [✕] │
│    890 KB                        │
└────────────────────────────────┘
```

**可以**：
- 👁️ 查看所有选中的文件
- ❌ 点击 `✕` 移除不需要的文件
- 🗑️ 点击"清空"按钮清空所有文件
- 📂 继续拖拽添加更多文件

### 第六步：上传并查看结果

点击 **"上传并分析"** 按钮后：

1. **进度提示**：会显示 "正在上传... (3/10)"
2. **上传完成**：显示成功数量
3. **AI自动分析**：系统会自动分析每个文件
4. **查看结果**：如果有失败文件，会显示详细原因

---

## 📊 上传结果说明

### 成功情况
```
✅ 全部 10 个文件上传成功！AI正在分析中...
```
所有文件都成功上传，正在后台AI分析。

### 部分失败
```
⚠️ 成功 8/10，失败 2/10
```
会显示详细结果列表：
- ✅ 《文件1.txt》成功
- ✅ 《文件2.txt》成功
- ❌ 《文件3.docx》失败 - 文件格式不支持
- ❌ 《文件4.pdf》失败 - 文件读取失败

---

## 💡 批量上传最佳实践

### 1. 文件命名规范

好的命名示例：
```
✅ 《他曾是我人间朝暮》-导语.txt
✅ 《他曾是我人间朝暮》-人物设定.txt
✅ 追妻火葬场-导语合集.txt
✅ 豪门恩怨-2024-01.txt
```

不好的命名：
```
❌ 1.txt
❌ 新建文本文档.txt
❌ 未命名.txt
```

**原因**：系统会从文件名自动提取标题，清晰的命名可以省去手动填写。

### 2. 分类上传

建议按类型分批上传：

**第一批：导语类**
- 内容类型选择："导语"
- 选择所有导语文件

**第二批：大纲类**
- 内容类型选择："大纲"
- 选择所有大纲文件

**第三批：拆解笔记**
- 内容类型选择："拆解笔记"
- 选择所有拆解笔记文件

这样可以自动分类，方便后续筛选使用。

### 3. 文件大小建议

- **单个文件**：建议 < 1MB
- **总大小**：建议一次 < 50MB
- **文件数量**：建议一次 < 50 个

如果文件过大或过多，可以分批上传。

---

## 🔧 批量上传后如何管理

### 1. 查看所有素材

上传完成后，素材库会自动刷新，显示所有已上传的素材。

### 2. 筛选和查找

使用顶部筛选器：
- **按类型筛选**：导语、大纲、拆解笔记、完整小说
- **按题材筛选**：世情文、追妻火葬场、豪门恩怨等

### 3. 查看AI分析结果

1. 找到已上传的素材
2. 点击 **查看** 按钮
3. 查看AI分析结果：
   - ✅ **已完成**：可以"写同款"
   - 🔄 **分析中**：请等待10-30秒
   - ❌ **分析失败**：可以重试

### 4. 批量"写同款"

分析完成后，可以：
1. 选择一个素材
2. 点击 **写同款**
3. 快速生成同款作品

---

## ⚡ 高级技巧

### 技巧1：零标题批量上传

如果文件名已经很规范，可以：

1. **作品标题**：留空
2. 拖拽或选择所有文件
3. 上传

系统会自动使用文件名作为标题：
```
《他曾是我人间朝暮》-导语.txt
→ 标题自动设置为：《他曾是我人间朝暮》-导语
```

### 技巧2：混合格式上传

可以同时选择：
- 5 个 .txt 文件
- 3 个 .docx 文件
- 2 个 .pdf 文件

系统会自动识别格式并处理。

### 技巧3：拖拽快速上传 ⭐ 新功能

**拖拽上传的优势**：
- 更快：选中 → 拖拽 → 松开，三步完成
- 更直观：直接看到要上传的文件
- 更灵活：可以分批拖拽添加文件

**操作步骤**：
1. 打开文件管理器，找到素材文件夹
2. 选中多个文件（Ctrl+A 全选，或手动多选）
3. 拖拽到上传区域
4. 松开鼠标
5. 预览文件列表，确认无误
6. 点击"上传并分析"

**分批拖拽示例**：
```
第一批：拖入 10 个导语文件 → 查看预览 → 确认
第二批：继续拖入 5 个大纲文件 → 查看预览 → 确认
第三批：再拖入 3 个拆解笔记 → 查看预览 → 上传
```

### 技巧4：文件预览和管理

上传前可以在预览列表中：
- ✅ 查看文件名和大小
- ❌ 移除不需要的文件（点击 ✕）
- 🗑️ 清空所有文件重新选择
- 📂 继续添加更多文件

**示例场景**：
```
拖拽了 20 个文件，发现有 3 个不对：
→ 在预览列表中点击这 3 个文件的 ✕ 按钮
→ 保留 17 个文件继续上传
```

### 技巧5：快速建立素材库

如果您有一个包含大量小说的文件夹：

```
我的素材库/
├── 狗血小说包/
│   ├── 导语合集.txt
│   ├── 人物设定.txt
│   └── 大纲模板.txt
└── 虐恋小说包/
    ├── 导语1.txt
    ├── 导语2.txt
    └── 导语3.txt
```

**拖拽方式**（推荐）：
1. 打开"狗血小说包"文件夹
2. Ctrl+A 全选文件
3. 拖拽到上传区域
4. 设置内容类型为"拆解笔记"
5. 上传
6. 重复步骤1-5处理"虐恋小说包"

---

## 📊 批量上传流程图

```
选择文件
    ↓
    ├─ 方式1：点击"选择多个文件"按钮
    └─ 方式2：拖拽文件/文件夹到上传区域 ⭐
    ↓
预览文件列表
    ↓
    ├─ 查看文件名和大小
    ├─ 移除不需要的文件 (点击 ✕)
    └─ 清空重新选择
    ↓
填写通用信息（可选）
    ↓
点击"上传并分析"
    ↓
显示进度 (3/10)
    ↓
上传完成 ✅
    ↓
AI自动分析（后台）
    ↓
几分钟后刷新页面
    ↓
所有素材显示"已完成"状态
    ↓
开始使用"写同款"功能
```

---

## 🎯 典型使用场景

### 场景1：导入拆文学习包（拖拽方式）

**您有**：一个包含50个小说拆解的文件夹

**操作**：
1. 内容类型选择："拆解笔记"
2. 打开文件夹，Ctrl+A 全选
3. 拖拽所有文件到上传区域
4. 预览文件列表，确认50个文件
5. 点击"上传并分析"
6. 等待10-20分钟（AI分析需要时间）
7. 刷新页面查看所有素材

**结果**：拥有50个已分析的拆解素材，可以随时查看学习，或点击"写同款"生成类似作品。

### 场景2：建立导语模板库

**您有**：20个经典狗血导语的txt文件

**操作**：
1. 内容类型选择："导语"
2. 拖拽所有文件到上传区域
3. 预览并确认文件列表
4. 上传
4. AI分析完成后，每个导语都有：
   - 题材标签
   - 核心冲突
   - 情绪风格
   - 人物特征

**结果**：可以随时选择一个导语素材，点击"写同款"生成新的狗血导语。

### 场景3：导入个人创作素材

**您有**：自己创作的小说/大纲

**操作**：
1. 选择您自己的文件
2. 作者填写：您的笔名
3. 来源：填写"原创"
4. 上传

**结果**：
- AI分析您的创作风格
- 可以基于自己的作品"写同款"
- 保持风格一致性

---

## ❓ 常见问题

### Q1: 批量上传会很慢吗？

**A**: 上传速度取决于：
- 文件大小
- 网络速度
- 服务器性能

通常：
- 小文件 (< 100KB)：每秒约5-10个
- 中等文件 (100KB-1MB)：每秒约2-5个
- 大文件 (> 1MB)：每个需要几秒钟

10个文件通常在1分钟内完成上传。

### Q2: 上传后可以删除吗？

**A**: 当前版本不支持删除。如需重新上传，请：
- 给文件添加版本号，如《书名》v2.txt
- 或等待删除功能开发

### Q3: AI分析需要多久？

**A**:
- **单个文件**：10-30秒
- **10个文件**：约2-5分钟（后台并行分析）
- **50个文件**：约10-20分钟

分析在后台进行，您可以关闭浏览器，稍后再回来查看。

### Q4: 如果某些文件失败了怎么办？

**A**: 会显示详细的失败原因：
- **文件格式不支持**：请转换为 .txt
- **文件读取失败**：检查文件是否损坏
- **其他错误**：查看具体错误信息

可以只重新上传失败的文件。

### Q5: 可以中途取消吗？

**A**: 当前版本不支持中途取消。正在上传的文件会完成上传。

如果需要取消：
1. 刷新页面
2. 已上传的文件会保留
3. 重新上传时注意不要选择已上传的

---

## 🎊 开始批量上传

**现在就试试吧！**

1. 打开：http://127.0.0.1:8000
2. 点击 **📚 素材库**
3. 点击 **+ 上传素材**
4. 选择多个文件
5. 点击 **上传并分析**

祝您使用愉快！ 📚✨
