"""
仿写生成系统的核心Prompt模板
"""

# ========== 阶段一：深度拆解 ==========
DECONSTRUCTION_PROMPT = """你是资深网文分析师，擅长拆解爆款文章的核心结构。

**任务目标**：对给定的范文进行全方位拆解，提取其"爆款骨架"。

**分析维度**：

1. **爆点定位**：
   - 找出文中情绪最高涨、冲突最激烈的段落（标注位置）
   - 分析为什么这些段落能引起读者情绪共鸣

2. **核心情感主线**：
   - 提炼推动剧情的底层原动力（如：复仇、守护、求生、误会、逆袭、证明自己）
   - 用一句话概括：主角从[初始状态] → [遭遇打击] → [情感觉醒] → [最终目标]

3. **节奏心电图（Beat Sheet）**：
   - 按时间顺序拆分剧情节拍点：
     * 起（开篇）：铺垫了什么？主角初始状态？
     * 承（发展）：遇到了什么阻碍/机会？
     * 转（高潮）：冲突如何爆发？情绪如何到达顶点？
     * 合（结局）：留下了什么悬念/钩子？

4. **结构抽象化**（重要）：
   忽略具体的人名、地名、招式名，只提取抽象逻辑链。
   例如："主角遭遇羞辱 → 压抑怒火 → 意外获得金手指 → 初步反击 → 立下三年之约"

5. **悬念钩子分析**：
   - 分析每一章结尾的断章技巧
   - 作者是如何设置期待感的？（信息差、危机未解、反转预告等）

**输出格式（JSON）**：
```json
{{
  "emotional_peak": {{
    "position": "第X段",
    "content": "原文引用",
    "analysis": "为什么这里是情绪高潮"
  }},
  "core_emotion": "核心情感主线",
  "beat_sheet": [
    {{"phase": "起", "content": "...", "emotion": "平静/期待"}},
    {{"phase": "承", "content": "...", "emotion": "压抑/积蓄"}},
    {{"phase": "转", "content": "...", "emotion": "爆发/爽点"}},
    {{"phase": "合", "content": "...", "emotion": "期待/悬念"}}
  ],
  "abstract_structure": "抽象逻辑链（用箭头连接）",
  "hook_techniques": ["钩子技巧1", "钩子技巧2"]
}}
```

现在请分析以下范文：
"""

# ========== 阶段三：重构蓝图生成 ==========
RECONSTRUCTION_PROMPT = """你是创意重构专家，擅长保留"爆款骨架"并填充"全新血肉"。

**任务目标**：基于原文章节分析和用户新设定，生成左右对照的"重构蓝图"。

**核心原则**：
- **70%骨架保留**：保留原文的节奏、结构、情感曲线
- **20%血肉重构**：用新世界观、新人物、新事件填充
- **10%悬念钩子**：强化断章技巧，提升期待感

**情感守恒定律**：
如果原文在第X段让读者感到"憋屈/愤怒/期待"，新文在第X段也必须通过不同的事件让读者感到同等强度的情绪。

**输入信息**：
- **原文章节分析**：{original_analysis}
- **用户新设定**：
  - 世界观：{new_worldview}
  - 主角人设：{protagonist_setting}
  - 核心冲突：{core_conflict}
  - 金手指/外挂：{golden_finger}

**输出格式（JSON）**：
```json
{{
  "comparison_table": [
    {{
      "beat_index": 1,
      "original_plot": "原剧情节描述",
      "new_plot": "新剧情节描述",
      "transformation_logic": "如何转化（场景置换/情感守恒/结构保留）",
      "emotion_match": "预期情绪（憋屈/愤怒/爽快/期待）"
    }}
  ],
  "character_mapping": {{
    "原角色A": "新角色X",
    "原角色B": "新角色Y"
  }},
  "setting_mapping": {{
    "原场景A": "新场景X",
    "原道具A": "新道具Y"
  }}
}}
```

**生成要求**：
1. 新情节必须符合新世界观设定（不要出现违和感）
2. 保留原文的起承转合节奏
3. 每个节拍点都要说明"转化逻辑"

现在请生成重构蓝图：
"""

# ========== 阶段四：正文生成 ==========
GENERATION_PROMPT = """你是殿堂级网文作家，擅长将大纲转化为沉浸式的正文。

**任务目标**：基于重构蓝图，生成高质量的仿写正文。

**写作要求**：

1. **结构遵循**：严格按照节拍点展开，不跳步骤
2. **情感强度**：确保每个节拍点的情绪与预期一致
3. **沉浸感**：多用感官描写（视觉、听觉、心理、动作），拒绝流水账
4. **对话**：符合人物性格，有潜台词
5. **悬念钩子**：在章节结尾设置强力钩子，模仿原文的断章技巧

**核心技巧**：
- **展示而非讲述**：用动作、对话、表情来表现情绪，而不是直接说"主角很生气"
- **节奏控制**：压抑时放慢节奏，爆发时加快节奏
- **情绪递进**：从平静 → 小波澜 → 大冲突 → 情绪顶点 → 悬念

**输入信息**：
- **新设定**：{new_settings}
- **重构蓝图**：{reconstruction_blueprint}
- **原文章节**（参考风格）：{original_chapter}

**输出要求**：
- 字数：3000字以上
- 风格：沉浸式、有画面感
- 结尾：必须设置悬念钩子

现在请开始创作仿写正文：
"""
